title = "FUEGO-APP gitleaks config (starter)"

# Allowlist (avoid false positives). Add patterns you trust.
[allowlist]
# Example: ignore local dev email placeholder
regexes = [
  '''example@example\.com'''
]
# Exclude certain file paths from scanning
paths = [
  '''node_modules/''',
  '''\.git/''',
  '''\.github/'''
]

# Generic rules
[[rules]]
id = "aws-access-key"
description = "AWS Access Key ID"
regex = '''AKIA[0-9A-Z]{16}'''
tags = ["aws","key","credential"]

[[rules]]
id = "aws-secret-access-key"
description = "AWS Secret Access Key"
regex = '''(?i)aws(.{0,20})?(secret|secret_access|secretAccess)?(.{0,20})?[A-Za-z0-9/+=]{40}'''
tags = ["aws","secret"]

[[rules]]
id = "postgres-connection"
description = "Postgres connection string"
# matches typical postgres://user:pass@host:port/db?params
regex = '''postgres(?:ql)?:\/\/[^\s'\"]+:[^\s'\"]+@[^\s'\"]+\/[^\s'\"]+'''
tags = ["db","postgres","connection"]

[[rules]]
id = "prisma-api-key"
description = "Prisma-style API key (prisma-data/prisma+postgres patterns)"
regex = '''(prisma\+postgres:\/\/|prisma:\/\/).*apikey.*|prisma[-_]?[A-Za-z0-9\-_]{20,}'''
tags = ["prisma","key"]

[[rules]]
id = "stripe-secret"
description = "Stripe secret key"
regex = '''sk_live_[0-9a-zA-Z]{24,}'''
tags = ["stripe","secret"]

[[rules]]
id = "generic-secret"
description = "Generic long secret (>= 40 chars) in quotes"
regex = '''["']([A-Za-z0-9/+=_-]{40,})["']'''
tags = ["secret","generic"]
